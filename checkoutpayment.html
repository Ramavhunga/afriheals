<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, height=device-height, minimum-scale=1.0, user-scalable=0">
    <meta name="referrer" content="origin">

    <title>Checkout</title>

    <meta data-browser="chrome" data-browser-major="81">
    <meta data-body-font-family="-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'" data-body-font-type="system">


    <link rel="stylesheet" type="text/css" href="css/checkout.css">


    <script src="js/checkout.js"></script>

    <style>
        .hasError {
            box-shadow: 0px 0px 5px #B90504;
            background: #fddfdf;
        }

        .validationMessage {
            display: none
        }
    </style>
    <link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">
</head>

<body  class="animsition">
    <a href="#main-header" class="skip-to-content">
        Skip to content
    </a>




    <header class="banner" data-header role="banner">
        <div class="wrap">

            <a class="logo logo--left" href="index.html"><span class="logo__text heading-1">Afriheals</span></a>

            <h1 class="visually-hidden">
                Payment
            </h1>


        </div>
    </header>

    <aside role="complementary">
        <button class="order-summary-toggle order-summary-toggle--show shown-if-js" aria-expanded="false" aria-controls="order-summary" data-drawer-toggle="[data-order-summary]">
            <span class="wrap">
                <span class="order-summary-toggle__inner">
                    <span class="order-summary-toggle__icon-wrapper">
                        <svg width="20" height="19" xmlns="http://www.w3.org/2000/svg" class="order-summary-toggle__icon">
                            <path d="M17.178 13.088H5.453c-.454 0-.91-.364-.91-.818L3.727 1.818H0V0h4.544c.455 0 .91.364.91.818l.09 1.272h13.45c.274 0 .547.09.73.364.18.182.27.454.18.727l-1.817 9.18c-.09.455-.455.728-.91.728zM6.27 11.27h10.09l1.454-7.362H5.634l.637 7.362zm.092 7.715c1.004 0 1.818-.813 1.818-1.817s-.814-1.818-1.818-1.818-1.818.814-1.818 1.818.814 1.817 1.818 1.817zm9.18 0c1.004 0 1.817-.813 1.817-1.817s-.814-1.818-1.818-1.818-1.818.814-1.818 1.818.814 1.817 1.818 1.817z" />
                        </svg>
                    </span>
                    <span class="order-summary-toggle__text order-summary-toggle__text--show">
                        <span>Show order summary</span>
                        <svg width="11" height="6" xmlns="http://www.w3.org/2000/svg" class="order-summary-toggle__dropdown" fill="#000"><path d="M.504 1.813l4.358 3.845.496.438.496-.438 4.642-4.096L9.504.438 4.862 4.534h.992L1.496.69.504 1.812z" /></svg>
                    </span>
                    <span class="order-summary-toggle__text order-summary-toggle__text--hide">
                        <span>Hide order summary</span>
                        <svg width="11" height="7" xmlns="http://www.w3.org/2000/svg" class="order-summary-toggle__dropdown" fill="#000"><path d="M6.138.876L5.642.438l-.496.438L.504 4.972l.992 1.124L6.138 2l-.496.436 3.862 3.408.992-1.122L6.138.876z" /></svg>
                    </span>
                    <span class="order-summary-toggle__total-recap total-recap" data-order-summary-section="toggle-total-recap">
                        <span class="total-recap__final-price skeleton-while-loading" data-checkout-payment-due-target="4000"></span>
                    </span>
                </span>
            </span>
        </button>
    </aside>



    <div class="content" data-content>
        <div class="wrap">
            <div class="main">
                <header class="main__header" role="banner">

                    <a class="logo logo--left" href="index.html"><span class="logo__text heading-1">Afriheals</span></a>

                    <h1 class="visually-hidden">
                        Payment
                    </h1>


                    <nav aria-label="Breadcrumb">
                        <ul class="breadcrumb ">
                            <li class="breadcrumb__item breadcrumb__item--completed">
                                <a class="breadcrumb__link" href="cart.html">Cart</a>
                                <svg class="icon-svg icon-svg--color-adaptive-light icon-svg--size-10 breadcrumb__chevron-icon" aria-hidden="true" focusable="false"> <use xlink:href="#chevron-right" /> </svg>
                            </li>

                            <li class="breadcrumb__item breadcrumb__item--completed">
                                <a class="breadcrumb__link" href="checkout.hmtl">Information</a>
                                <svg class="icon-svg icon-svg--color-adaptive-light icon-svg--size-10 breadcrumb__chevron-icon" aria-hidden="true" focusable="false"> <use xlink:href="#chevron-right" /> </svg>
                            </li>
                            <li class="breadcrumb__item breadcrumb__item--completed">
                                <a class="breadcrumb__link" href="checkoutdelivery.html">Shipping</a>
                                <svg class="icon-svg icon-svg--color-adaptive-light icon-svg--size-10 breadcrumb__chevron-icon" aria-hidden="true" focusable="false"> <use xlink:href="#chevron-right" /> </svg>
                            </li>
                            <li class="breadcrumb__item breadcrumb__item--current" aria-current="step">
                                <span class="breadcrumb__text">Payment</span>
                            </li>
                        </ul>
                    </nav>



                    <div class="shown-if-js" data-alternative-payments>
                    </div>



                </header>
                <main class="main__content" role="main">

                    <div class="step" data-step="payment_method" data-last-step="true">
                        <div class="step__sections" data-model="cart">
                            <div class="section">
                                <div class="content-box">
                                    <div role="table" class="content-box__row content-box__row--tight-spacing-vertical">
                                        <div role="row" class="review-block">
                                            <div class="review-block__inner">
                                                <div role="rowheader" class="review-block__label">
                                                    Contact
                                                </div>
                                                <div role="cell" class="review-block__content">
                                                    <bdo dir="ltr" data-bind="text:cart.names"></bdo>
                                                </div>
                                            </div>
                                            <div role="cell" class="review-block__link">
                                                <a class="link--small" href="checkout.html">
                                                    <span aria-hidden="true">Change</span>
                                                    <span class="visually-hidden">Change contact information</span>
                                                </a>
                                            </div>
                                        </div>

                                        <div role="row" class="review-block">
                                            <div class="review-block__inner">
                                                <div role="rowheader" class="review-block__label">
                                                    Shipping
                                                </div>
                                                <div role="cell" class="review-block__content" data-review-section="shipping-cost" data-bind="text:cart.delivery_method">

                                                    <strong class="emphasis">
                                                        <span class="skeleton-while-loading--inline" data-bind="text:cart.delivery_price"></span>
                                                    </strong>
                                                </div>
                                            </div>
                                            <div role="cell" class="review-block__link">
                                                <a class="link--small" href="checkoutdelivery.html">
                                                    <span aria-hidden="true">Change</span>
                                                    <span class="visually-hidden">Change contact information</span>
                                                </a>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>

                            <br />



                            <div class="edit_checkout" data-payment-form="" accept-charset="UTF-8" method="post">
                                <div class="section section--payment-method" data-payment-method>
                                    <div class="section__header">
                                        <h2 class="section__title" id="main-header" tabindex="-1">
                                            Payment
                                        </h2>
                                        <p class="section__text">
                                            All transactions are secure and encrypted.
                                        </p>
                                    </div>
                                    <div class="section__content">
                                        <!--<div class="notice notice--warning default-background" data-banner="true" role="status" tabindex="-1" aria-atomic="true" aria-live="polite"><svg class="icon-svg icon-svg--size-24 notice__icon" aria-hidden="true" focusable="false"> <use xlink:href="#warning" /> </svg><div class="notice__content"><p class="notice__text">This store can&#39;t accept real orders or real payments.</p></div></div>-->

                                        <div class="fieldset">
                                            <div data-email-or-phone-input-wrapper="true" data-shopify-pay-email-flow="false" class="field  field--show-floating-label">

                                                <div class="field__input-wrapper">
                                                    <label class="field__label field__label--visible" for="checkout_email_or_phone">Payment Method</label>
                                                    <select placeholder="Payment Method" autocomplete="shipping address-level1" autocorrect="off" data-backup="province" class="field__input field__input--select" data-bind="value:cart.paymentmethod,options:cart.paymentmethods,optionsValue:'paymentcode',optionsText:'name',optionsCaption:'Select Payment Method',css:cart.paymentmethod()?'':'hasError'">
                                                    </select>

                                                </div>

                                           
                                            </div>
                                        </div>
                                        <br />

                                        <div data-bind="visible: paymentmethod()=='card'">
                                            <div class="content-box">
                                                <div class="radio-wrapper content-box__row ">


                                                    <div class="radio__label payment-method-wrapper radio__label--inactive">
                                                        <h3 class="radio__label__primary content-box__emphasis">
                                                            Credit card, Payfast
                                                        </h3>
                                                        <span class="radio__label__accessory">
                                                            <span class="visually-hidden">
                                                                Pay with:
                                                            </span>

                                                            <span data-brand-icons-for-gateway="12063768618">
                                                                <span class="payment-icon payment-icon--visa" data-payment-icon="visa">
                                                                    <span class="visually-hidden">
                                                                        Visa,
                                                                    </span>
                                                                </span>              <span class="payment-icon payment-icon--master" data-payment-icon="master">
                                                                    <span class="visually-hidden">
                                                                        Mastercard,
                                                                    </span>
                                                                </span>              <span class="payment-icon payment-icon--american-express" data-payment-icon="american-express">
                                                                    <span class="visually-hidden">
                                                                        Debit Card,
                                                                    </span>
                                                                </span>              <span class="payment-icon payment-icon--discover" data-payment-icon="discover">
                                                                    <span class="visually-hidden">
                                                                        Credit,
                                                                    </span>
                                                                </span>
                                                                <span class="payment-icon-list__more">
                                                                    <span class="content-box__small-text">
                                                                        and more…
                                                                    </span>
                                                                </span>
                                                            </span>
                                                        </span>
                                                    </div>
                                                    <div aria-live="polite" data-detected="Detected card brand: {brand}">
                                                    </div>
                                                </div>

                                                <div class="radio-wrapper content-box__row content-box__row--secondary">
                                                    <div class="blank-slate" data-order-summary-section="offsite">
                                                        <i class="blank-slate__icon icon icon--offsite"></i>
                                                        <p class="shown-if-js">After clicking “Complete order”, you will be redirected to Credit/Debit card,Instant EFT, Payfast to complete your purchase securely.</p>
                                                        <!--<p class="hidden-if-js">After clicking “Continue to payment”, you will be redirected to Credit card,Instant EFT,Payfast to complete your purchase securely.</p>-->

                                                    </div>
                                                </div>



                                            </div>
                                        </div>

                                        <div data-bind="visible: paymentmethod()=='cashsend'">
                                            <div class="content-box">
                                                <div class="radio-wrapper content-box__row ">


                                                    <div class="radio__label payment-method-wrapper radio__label--inactive">
                                                        <h3 class="radio__label__primary content-box__emphasis">
                                                            Ewallet, CashSend, InstactMoney, Capitec no Transfer, Account Deposit
                                                        </h3>
                                                  
                                                    </div>
                                                    <!--<div aria-live="polite" data-detected="Detected card brand: {brand}">
                                </div>-->
                                                </div>

                                                <div class="radio-wrapper content-box__row content-box__row--secondary">
                                                    <div class="blank-slate" data-order-summary-section="offsite">
                                                        <!--<i class="blank-slate__icon icon icon--offsite"></i>-->
                                                        <p class="shown-if-js"><b>After clicking “Complete order”,a reference will be provided payment can be done in the following methods :</b> </p><br />
                                                        <p class="shown-if-js">Cash Send ,Ewallet,Instant Money ,Capitec transfer are all welcomed to the following No :076 182 3476</p><br />
                                                        <p class="shown-if-js"><b>Account details:</b></p><br />
                                                        <p class="shown-if-js">Account Name : Muthwaks Solutions</p>
                                                        <p class="shown-if-js">Bank: First National Bank(FNB)</p>
                                                        <p class="shown-if-js">Account Number: 6259 420 7188</p>
                                                        <p class="shown-if-js">Branch Code: 250455</p>
                                                        <p class="shown-if-js">Reference: Reference No</p>
                                                        <!--'Cash Send ,Ewallet,Instant Money ,Capitec transfer are all welcomed to the following No :076 182 3476 Account Name : Muthwaks Solutions<br />Bank: First National Bank(FNB)<br />Account Number: 6259 420 7188<br />Branch Code: 250455<br />Reference: Refernce No'-->
                                                        <!--<p class="hidden-if-js">After clicking “Continue to payment”, you will be redirected to Credit card,Instant EFT,Payfast to complete your purchase securely.</p>-->

                                                    </div>
                                                </div>



                                            </div>
                                        </div>


                                        <div data-payment-subform="gift_cards" class="hidden">
                                            <input value="free" disabled="disabled" size="30" type="hidden" name="checkout[payment_gateway]" />
                                            <div class="content-box blank-slate">
                                                <div class="content-box__row">
                                                    <i class="blank-slate__icon icon icon--free-tag"></i>
                                                    <!--<p>Your order is covered by your gift cards.</p>-->
                                                </div>
                                            </div>
                                        </div>
                                        <div data-payment-subform="free" class="hidden"></div>
                                    </div>
                                </div>



                                <div class="step__footer" data-step-footer>
                                    <input type="hidden" name="checkout[total_price]" id="checkout_total_price" value="4000" data-bind="text: 'R'+ cart.final_total()" />
                                    <input type="hidden" name="complete" value="1" />

                                    <div class="shown-if-js">
                                        <button name="button" type="submit" id="continue_button" class="step__footer__continue-btn btn  btnCompleteOrder" aria-busy="false"><span class="btn__content" data-continue-button-content="true">Complete order</span><svg class="icon-svg icon-svg--size-18 btn__spinner icon-svg--spinner-button" aria-hidden="true" focusable="false"> <use xlink:href="#spinner-button" /> </svg></button>
                                    </div>                              
                                    <a class="step__footer__previous-link" href="checkoutdelivery.html"><svg focusable="false" aria-hidden="true" class="icon-svg icon-svg--color-accent icon-svg--size-10 previous-link__icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 10"><path d="M8 1L7 0 3 4 2 5l1 1 4 4 1-1-4-4" /></svg><span class="step__footer__previous-link-content">Return to shipping</span></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
                <footer class="main__footer" role="contentinfo">
                    <p class="copyright-text">
                        All rights reserved Afriheals
                    </p>
                </footer>
            </div>
            <aside class="sidebar" role="complementary">
                <div class="sidebar__header">

                    <a class="logo logo--left" href="index.html"><span class="logo__text heading-1">Afriheals</span></a>

                    <h1 class="visually-hidden">
                        Payment
                    </h1>
                </div>
                <div class="sidebar__content" data-model="cart">
                    <div id="order-summary" class="order-summary order-summary--is-collapsed" data-order-summary>
                        <h2 class="visually-hidden-if-js">Order summary</h2>

                        <div class="order-summary__sections">
                            <div class="order-summary__section order-summary__section--product-list">
                                <div class="order-summary__section__content">
                                    <table class="product-table">
                                        <caption class="visually-hidden">Shopping cart</caption>
                                        <thead class="product-table__header">
                                            <tr>
                                                <th scope="col"><span class="visually-hidden">Product image</span></th>
                                                <th scope="col"><span class="visually-hidden">Description</span></th>
                                                <th scope="col"><span class="visually-hidden">Quantity</span></th>
                                                <th scope="col"><span class="visually-hidden">Price</span></th>
                                            </tr>
                                        </thead>
                                        <tbody data-order-summary-section="line-items" data-bind="foreach:cartlist">
                                            <tr class="product" data-product-id="700901687338" data-variant-id="8772548821034" data-product-type="Shirts" data-customer-ready-visible>
                                                <td class="product__image">
                                                    <div class="product-thumbnail ">
                                                        <div class="product-thumbnail__wrapper">
                                                            <img class="product-thumbnail__image" data-bind="attr:{src:cart_pic}">
                                                        </div>
                                                        <span class="product-thumbnail__quantity" aria-hidden="true" data-bind="text:quantity"></span>
                                                    </div>

                                                </td>
                                                <th class="product__description" scope="row">
                                                    <span class="product__description__name order-summary__emphasis" data-bind="text:productname"></span>
                                                </th>
                                                <td class="product__quantity visually-hidden" data-bind="text:quantity">
                                                </td>
                                                <td class="product__price">
                                                    <span class="order-summary__emphasis skeleton-while-loading" data-bind="text: 'R'+ price()"></span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>

                                    <div class="order-summary__scroll-indicator" aria-hidden="true" tabindex="-1">
                                        Scroll for more items
                                        <svg aria-hidden="true" focusable="false" class="icon-svg icon-svg--size-12"> <use xlink:href="#down-arrow" /> </svg>
                                    </div>
                                </div>
                            </div>



                            <div class="order-summary__section order-summary__section--total-lines" data-order-summary-section="payment-lines">
                                <table class="total-line-table">
                                    <caption class="visually-hidden">Cost summary</caption>
                                    <thead>
                                        <tr>
                                            <th scope="col"><span class="visually-hidden">Description</span></th>
                                            <th scope="col"><span class="visually-hidden">Price</span></th>
                                        </tr>
                                    </thead>
                                    <tbody class="total-line-table__tbody">
                                        <tr class="total-line total-line--subtotal">
                                            <th class="total-line__name" scope="row">Subtotal</th>
                                            <td class="total-line__price">
                                                <span class="order-summary__emphasis skeleton-while-loading" data-checkout-subtotal-price-target="2000" data-bind="text: 'R'+ cart.grand_total()">

                                                </span>
                                            </td>
                                        </tr>


                                        <tr class="total-line total-line--shipping">
                                            <th class="total-line__name" scope="row">
                                                <span>
                                                    Shipping
                                                </span>
                                            </th>
                                            <td class="total-line__price">
                                                <span class="skeleton-while-loading order-summary__emphasis" data-checkout-total-shipping-target="2000" data-bind="text: 'R'+ cart.delivery_price()">

                                                </span>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot class="total-line-table__footer">
                                        <tr class="total-line">
                                            <th class="total-line__name payment-due-label" scope="row">
                                                <span class="payment-due-label__total">Total</span>
                                            </th>
                                            <td class="total-line__price payment-due">
                                                <span class="payment-due__currency remove-while-loading">Rands</span>
                                                <span class="payment-due__price skeleton-while-loading--lg" data-checkout-payment-due-target="4000" data-bind="text: 'R'+ cart.final_total()">

                                                </span>
                                            </td>
                                        </tr>
                                    </tfoot>
                                </table>

                            </div>
                        </div>
                    </div>
                </div>
            </aside>
        </div>
    </div>


    <script type="text/javascript" src="vendor/jquery/jquery-3.2.1.min.js"></script>
    <!--===============================================================================================-->
    <script type="text/javascript" src="vendor/animsition/js/animsition.min.js"></script>
    <!--===============================================================================================-->
    <script type="text/javascript" src="vendor/bootstrap/js/popper.js"></script>
    <script type="text/javascript" src="vendor/bootstrap/js/bootstrap.min.js"></script>
    <!--===============================================================================================-->
    <script type="text/javascript" src="vendor/select2/select2.min.js"></script>
    <script type="text/javascript">
        $(".selection-1").select2({
            minimumResultsForSearch: 20,
            dropdownParent: $('#dropDownSelect1')
        });

        $(".selection-2").select2({
            minimumResultsForSearch: 20,
            dropdownParent: $('#dropDownSelect2')
        });
    </script>
    <!--===============================================================================================-->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAKFWBqlKAGCeS1rMVoaNlwyayu0e0YRes"></script>
    <!--<script src="js/map-custom.js"></script>-->
    <!--===============================================================================================-->
    <script src="js/main.js"></script>
    <script type="text/javascript" src="vendor/sweetalert/sweetalert.min.js"></script>
    <script type="text/javascript" src="vendor/knockout/jquery.base64.js"></script>
    <script type="text/javascript" src="vendor/knockout/jquery.json.min.js"></script>
    <script type="text/javascript" src="vendor/knockout/jquery.cookie.js"></script>
    <script type="text/javascript" src="vendor/knockout/jsrender.min.js"></script>

    <script type="text/javascript" src="vendor/knockout/jquery.easing.1.3.js"></script>
    <script type="text/javascript" src="js/localstorage.js"></script>

    <script type="text/javascript" src="vendor/knockout/knockout-3.4.0.js"></script>
    <script type="text/javascript" src="vendor/knockout/knockout.mapping-latest.js"></script>
    <script type="text/javascript" src="vendor/knockout/knockout.merge.js"></script>
    <script type="text/javascript" src="vendor/knockout/knockout-switch-case.min.js"></script>

    <script src="vendor/knockout/amplify.min.js"></script>
    <script type="text/javascript" src="vendor/knockout/jquery.livequery.min.js"></script>
    <script type="text/javascript" src="vendor/knockout/knockout.multimodels-0.1.min.js"></script>
    <script src="vendor/knockout/knockout.validation.min.js"></script>
    <script type="text/javascript" src="js/models.js"></script>
    <script src="js/data-layer.js"></script>
    <script type="text/javascript">
        $(".selection-1").select2({
            minimumResultsForSearch: 20,
            dropdownParent: $('#dropDownSelect1')
        });

        $(".selection-2").select2({
            minimumResultsForSearch: 20,
            dropdownParent: $('#dropDownSelect2')
        });
    </script>
    <!--===============================================================================================-->
    <script src="js/main.js"></script>
    <script>
        var products = null;
        var cart = null;
        (function ($) {


            productsFn = function () {
                var self = this;
                self.productlist = ko.observableArray(DL.getProducts())

            }

            cartfn = models.cartFn();


            if (mysession.getcarts() == undefined &&mysession.getcarts() == null) {
                cart = ko.mapping.fromJS(models.cartFn());
                products = ko.mapping.fromJS(new productsFn());
            } else {

                cart = ko.mapping.fromJS(mysession.getcarts(), {}, cartfn);
                products = ko.mapping.fromJS(mysession.getproducts());
            }

            //cart.delivery_methods(DL.getDeliveryMethods());
            cart.paymentmethods(DL.getPaymentMethods())

            ko.attach("products", products);
            ko.attach("cart", cart);


            

            //set validations
            //  models.validation_settings();

            ko.validation.init({
                decorateElement: true,
                errorElementClass: 'hasError',
                errorClass: 'hasError'
            });

            if (cart.cartlist().length == 0) {
                Swal.fire("No cart", "Im sending you back to shopping", "warning").then(function () {
                    debugger;
                    window.location = "index.html"
                });
            }

            cart.cartlist.subscribe(function (data) {
                var total = 0;
                ko.utils.arrayForEach(cart.cartlist(), function (data) {
                    debugger;
                    total += (data.price() * data.quantity());

                });
                cart.grand_total(parseFloat(total).toFixed(2));
                cart.delivery_price('0.00');
                if (cart.grand_total() < 1001 && cart.delivery_method() != '') {

                    var price;
                    debugger;
                    switch (cart.delivery_method()) {
                        case 'handtohand':


                            ko.utils.arrayForEach(cart.delivery_methods(), function (data) {
                                if (data.deliverycode == 'handtohand')
                                    price = data.price;
                            });
                            break;
                        case 'pep':
                            ko.utils.arrayForEach(cart.delivery_methods(), function (data) {
                                if (data.deliverycode == 'pep')
                                    price = data.price;
                            });
                            break;
                        case 'postnet':
                            ko.utils.arrayForEach(cart.delivery_methods(), function (data) {
                                if (data.deliverycode == 'postnet')
                                    price = data.price;
                            });
                            break;
                    }
                    cart.delivery_price(price);
                    //    if (cart.delivery_method() == 'handtohand') {
                    //        cart.province() == 'GP' ? cart.delivery_price('100.00') : cart.delivery_price('110.00');
                    //    } else if (cart.delivery_method() == 'handtohand') {}

                } else {
                    cart.delivery_price('0');
                }


                cart.final_total(parseFloat(parseFloat(cart.grand_total()) + parseFloat(cart.delivery_price())).toFixed(2));

               mysession.setcart(ko.toJS(cart));
               mysession.setproducts(ko.toJS(products))

            });

            cart.delivery.subscribe(function (data) {
                if (data == "yes") {
                    cart.city("")
                    cart.postalcode("");
                    cart.province("");
                    cart.physical_address("")
                } else {
                    cart.city("N/A")
                    cart.postalcode("N/A");
                    cart.province("GP");
                    cart.physical_address("N/A");
                }

            })

        })(jQuery);

        //$(document).on('click', '.placeorder', function () {

        //    if (cart.errors() == 0) {
        //        DL.sendEmail(ko.toJS(cart), doneloading);

        //    } else {
        //        cart.show_errors(true);
        //        swal("Fields not populate", "Populate all the required fields marked in red", "warning")
        //    }

        //})

        $(document).on('click', '.btncontinue', function () {

            if (cart.errors() == 0) {
               mysession.setcart(ko.toJS(cart));
                window.location = "checkoutpayment.html";

            } else {
                cart.show_errors(true);
                Swal.fire("Fields not populate", "Populate all the required fields marked in red", "warning")
            }

        });

        $(document).on('click', '.btnCompleteOrder', function () {
            debugger;
            if (cart.errors() == 0) {
                var splitamount = cart.final_total().split(".");
                debugger;

                var referenceno = "Afr" + new Date().getMilliseconds() + splitamount[0];
                cart.referenceno(referenceno);
               mysession.setcart(ko.toJS(cart));

                //DL.sendInvoiceEmail(ko.toJS(cart));

                   if (cart.paymentmethod() == 'card') {
                       DL.paymentURL(ko.toJS(cart));
                   } else if (cart.paymentmethod() == 'cashsend') {
                       cart.status(1);
                       DL.processOrder(ko.toJS(cart),successCompleteOrderFn);
                   }

                //mysession.setcart(ko.toJS(cart));
               // window.location = "checkoutpayment.html";

            } else {
                //cart.show_errors(true);
                Swal.fire("Fields not populate", "Populate all the required fields marked in red", "warning")
            }

        });
        
        function successCompleteOrderFn(data) {
            debugger;
           mysession.clearcart();
           mysession.clearproducts();
            mysession.clearproduct_info();
            Swal.fire(
                cart.referenceno() + " order has been placed and is on hold till payment is done, an invoice has been sent to you via email with the reference and payment process",
                "Cash Send ,Ewallet,Instant Money ,Capitec transfer are all welcomed to the following No :<b>076 182 3476 <br/><br>Account details:</b><br>Account Name : Muthwaks Solutions<br>Bank: First National Bank(FNB)<br>Account Number: 6259 420 7188<br>Branch Code: 250455<br>Reference:" + cart.referenceno(),
                "success").then(function () {
                window.location = "index.html";
            });

        }

        


        ko.bindingHandlers.fadeVisible = {
            init: function (element, valueAccessor) {

                var value = valueAccessor();
                $(element).toggle(ko.unwrap(value));
            },
            update: function (element, valueAccessor) {
                var value = valueAccessor();
                ko.unwrap(value) ? $(element).fadeIn() : $(element).fadeOut();
            }
        };

        function doneloading(data) {
            if (data.Status) {
                   mysession.clearcart();
                   mysession.clearproducts();
                   mysession.clearproduct_info();
                Swal.fire("Your order is :" + data.Data, "order has been successully processed, An email has been sent to you with the reference and payment process", "success").then(function () {
                    window.location = "index.html"
                })

            } else {
                Swal.fire("An error has occured! take a screen shot and send it to 076 182 3476 / info@afriheals.co.za", data.Message, "warning")
            }


        }

    </script>

</body>
</html>
